@model Dealermotor.Models.Order
@{
    ViewData["Title"] = "Detail Pesanan";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="admin-card">
    <div class="admin-card-header">
        <h4><i class="fas fa-receipt"></i> Detail Pesanan #@Model.Id.Substring(0, 8)</h4>
        <a asp-action="Orders" class="btn btn-admin-secondary">
            <i class="fas fa-arrow-left"></i> Kembali
        </a>
    </div>

    <div class="row mb-4">
        <div class="col-md-6">
            <h5
                style="color: var(--admin-gold); font-weight: bold; margin-bottom: 20px; border-bottom: 2px solid var(--admin-gold); padding-bottom: 10px;">
                <i class="fas fa-info-circle"></i> Informasi Pesanan
            </h5>
            <div style="background: #2d2d2d; border: 2px solid var(--admin-gold); border-radius: 10px; padding: 20px;">
                <table style="width: 100%;">
                    <tr style="margin-bottom: 10px;">
                        <td width="150" style="color: var(--admin-gold); padding: 8px 0;"><strong>Order ID:</strong></td>
                        <td style="color: white; padding: 8px 0;">#@Model.Id</td>
                    </tr>
                    <tr style="margin-bottom: 10px;">
                        <td style="color: var(--admin-gold); padding: 8px 0;"><strong>Customer:</strong></td>
                        <td style="color: white; padding: 8px 0;">@ViewBag.CustomerName</td>
                    </tr>
                    <tr style="margin-bottom: 10px;">
                        <td style="color: var(--admin-gold); padding: 8px 0;"><strong>Email:</strong></td>
                        <td style="color: white; padding: 8px 0;">@ViewBag.CustomerEmail</td>
                    </tr>
                    <tr style="margin-bottom: 10px;">
                        <td style="color: var(--admin-gold); padding: 8px 0;"><strong>Telepon:</strong></td>
                        <td style="color: white; padding: 8px 0;">@ViewBag.CustomerPhone</td>
                    </tr>
                    <tr style="margin-bottom: 10px;">
                        <td style="color: var(--admin-gold); padding: 8px 0;"><strong>Tanggal:</strong></td>
                        <td style="color: white; padding: 8px 0;">@Model.OrderDate.ToString("dd MMMM yyyy HH:mm")</td>
                    </tr>
                    <tr style="margin-bottom: 10px;">
                        <td style="color: var(--admin-gold); padding: 8px 0;"><strong>Status:</strong></td>
                        <td style="padding: 8px 0;">
                            @if (Model.Status == "Pending")
                            {
                                <span class="badge bg-warning">Pending</span>
                            }
                            else if (Model.Status == "Processing")
                            {
                                <span class="badge bg-info">Processing</span>
                            }
                            else if (Model.Status == "Shipped")
                            {
                                <span class="badge bg-primary">Shipped</span>
                            }
                            else if (Model.Status == "Delivered")
                            {
                                <span class="badge bg-success">Delivered</span>
                            }
                            else
                            {
                                <span class="badge bg-danger">Cancelled</span>
                            }
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="col-md-6">
            <h5
                style="color: var(--admin-gold); font-weight: bold; margin-bottom: 20px; border-bottom: 2px solid var(--admin-gold); padding-bottom: 10px;">
                <i class="fas fa-map-marker-alt"></i> Alamat Pengiriman
            </h5>
            <div style="background: #2d2d2d; border: 2px solid var(--admin-gold); border-radius: 10px; padding: 20px;">
                <p style="color: white; margin: 0; line-height: 1.6;">@Model.ShippingAddress</p>
            </div>
        </div>
    </div>

    <h5
        style="color: var(--admin-gold); font-weight: bold; margin-bottom: 20px; border-bottom: 2px solid var(--admin-gold); padding-bottom: 10px;">
        <i class="fas fa-box"></i> Item Pesanan
    </h5>
    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr style="background: var(--admin-black);">
                    <th style="color: var(--admin-gold);">Motor</th>
                    <th class="text-center" style="color: var(--admin-gold);">Jumlah</th>
                    <th class="text-end" style="color: var(--admin-gold);">Harga</th>
                    <th class="text-end" style="color: var(--admin-gold);">Subtotal</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.Items != null && Model.Items.Count > 0)
                {
                    @foreach (var item in Model.Items)
                    {
                        <tr>
                            <td style="color: white; background: #2d2d2d;"><strong>@item.MotorName</strong></td>
                            <td class="text-center" style="color: white; background: #2d2d2d;">@item.Quantity</td>
                            <td class="text-end" style="color: white; background: #2d2d2d;">Rp @item.Price.ToString("N0")</td>
                            <td class="text-end" style="color: var(--admin-gold); background: #2d2d2d;"><strong>Rp @((item.Price * item.Quantity).ToString("N0"))</strong></td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="4" class="text-center" style="color: white; background: #2d2d2d;">Tidak ada item</td>
                    </tr>
                }
            </tbody>
            <tfoot>
                <tr style="background: rgba(255, 215, 0, 0.2);">
                    <td colspan="3" class="text-end" style="color: white;">
                        <h5 class="mb-0">TOTAL:</h5>
                    </td>
                    <td class="text-end">
                        <h4 class="text-success mb-0">Rp @Model.TotalAmount.ToString("N0")</h4>
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>

    <div class="mt-4">
        <h5
            style="color: var(--admin-gold); font-weight: bold; margin-bottom: 20px; border-bottom: 2px solid var(--admin-gold); padding-bottom: 10px;">
            <i class="fas fa-edit"></i> Update Status Pesanan
        </h5>
        <div class="d-flex gap-2 flex-wrap">
            <form method="post" asp-action="UpdateOrderStatus" class="d-inline">
                <input type="hidden" name="orderId" value="@Model.Id" />
                <input type="hidden" name="status" value="Processing" />
                <button type="submit" class="btn btn-info">
                    <i class="fas fa-cog"></i> Processing
                </button>
            </form>
            <form method="post" asp-action="UpdateOrderStatus" class="d-inline">
                <input type="hidden" name="orderId" value="@Model.Id" />
                <input type="hidden" name="status" value="Shipped" />
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-truck"></i> Shipped
                </button>
            </form>
            <form method="post" asp-action="UpdateOrderStatus" class="d-inline">
                <input type="hidden" name="orderId" value="@Model.Id" />
                <input type="hidden" name="status" value="Delivered" />
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-check"></i> Delivered
                </button>
            </form>
            <form method="post" asp-action="UpdateOrderStatus" class="d-inline"
                onsubmit="return confirm('Yakin cancel pesanan ini?')">
                <input type="hidden" name="orderId" value="@Model.Id" />
                <input type="hidden" name="status" value="Cancelled" />
                <button type="submit" class="btn btn-danger">
                    <i class="fas fa-times"></i> Cancelled
                </button>
            </form>
        </div>
    </div>
</div>
